<!doctype html>
<html lang="pt-br">

  <head>
    <meta charset="utf-8">

    <title>Curso - Performance de aplicações em produção usando Node.js - Code Prestige</title>

    <meta name="description" content="Curso de performance de aplicações web utilizando Node.js da Code Prestige">
    <meta name="author" content="Lucas H. C. dos Santos">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/league.css" id="theme">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">








        <!-- Título -->
        <section>
          <h1>Performance de aplicações Node.js</h1>
          <h4>O Node como você nunca viu</h3>
          <p>
            <small>
              Instrutor: <a href="http://lsantos.me" target="_blank">Lucas Santos</a>
            </small>
          </p>
          <p>
            <small>
              Realização: <a href="http://www.codeprestige.com.br" target="_blank">Code Prestige</a>
            </small>
          </p>
        </section>









        <!-- Escola -->
        <section>
          <h2>Code Prestige</h2>
          <p>
            A Code Prestige é uma escola especializada no ensino de programação. Desenvolvemos diariamente artigos, cursos, livros digitais, vídeos e outros conteúdos que já auxiliaram mais de 4000 pessoas de todo o Brasil a alcançarem seus objetivos profissionais.
          </p>
          <p><small>Visite o nosso site! <br/><a href="http://www.codeprestige.com.br/">Code Prestige</a></small></p>
        </section>









        <!-- Instrutor -->
        <section>
          <section>
            <h2>Instrutor</h2>
            <div>
              <img data-src="https://s.gravatar.com/avatar/ce3a5c87b336b0a3f582055f38a5d78f?s=480&r=pg" />
            </div>
          </section>

          <section>
            <div>
              <ul>
                <li><b>Nome:</b> Lucas Santos</li>
                <li><b>Idade:</b> 22 anos</li>
                <li><b>Software Engineer</b> na <a href="http://squidit.com.br">Squid</a></li>
                <li><b>Minibio:</b> Membro de comunidades como o <a target="_blank" href="http://trainingcenter.io">Training Center</a>, organiza eventos como o <a target="_blank" href="http://2018.abcdevelopers.org">ABC Dev</a>, escrever algumas besteiras no <a href="https://medium.com/@khaosdoctor">Medium</a> e adora ensinar outras pessoas sobre o que aprendeu como profissional de desenvolvimento desde 2011.</li>
              </ul>
            </div>
          </section>

          <section>
            <h2>Redes sociais</h2>
            <ul>
              <li>Twitter: <a href="http://twitter.com/_staticvoid">@_staticvoid</a></li>
              <li>Github: <a href="http://github.com/khaosdoctor">khaosdoctor</a></li>
              <li>Site: <a href="https://lsantos.me">lsantos.me</a></li>
            </ul>
          </section>
        </section>


        <!-- Requisitos -->
        <section>
          <h2>Requisitos</h2>
          <ul>
            <li><a href="https://nodejs.org/en/" target="_blank">Node (versão > 8 LTS)</a></li>
            <li><a href="https://www.npmjs.com/" target="_blank">npm (versão > 3.x)</a></li>
            <li><a href="https://docs.docker.com/compose/install/" target="_blank">Docker compose</a></li>
            <li>
              <a href="https://www.docker.com/community-edition" target="_blank">Docker</a>
              <ul>
                <li>Baixar as imagens:
                    <ul>
                      <li>nginx (1.13-alpine, latest)</li>
                      <li>node (8, 9-alpine)</li>
                      <li>mongo</li>
                      <li>redis</li>
                    </ul>
                </li>
              </ul>
            </li>
            <li>Editor de texto</li>
          </ul>
        </section>












        <!-- Seção de intro ao Node -->
        <section>
          <section>
              <h3>Node.js</h3>
              <ul>
                <li>Versão atual: 8.9.4 (LTS) | 9.5.0 (Edge)</li>
                <li>Criada por: Ryan Dahl, em 2009</li>
                <li>Primeiro release: Novembro de 2009, na JSConf EU</li>
                <li>A ideia original veio do loader do Flickr, que tinha que ficar consultando o server para saber o progresso do upload</li>
              </ul>
          </section>

          <section>
              <h2>Você sabe o que é o Node?</h2>
              <p>
                Node.js não é uma <i>linguagem</i> nem uma <i>plataforma</i>, mas sim um <b>runtime</b> de desenvolvimento Javascript.
              </p>
          </section>

          <section>
            <h2>E o que significa?</h2>
            <p>O Node utiliza de uma série de projetos antes criados (como o V8) para a Web para "transpilar" o código JavaScript a fim de que ele também possa rodar no Back-end.</p>
          </section>

          <section>
            <h2>Na prática</h2>
          </section>

          <section>
            <img src="/img/node-turtle.png" alt="">
          </section>

          <section>
            <h1>Resumindo...</h1>
            <p>Node é uma ferramenta que pega seu código JS e compila para C++ a fim de que ele possa ser rodado no servidor.</p>
          </section>
        </section>













        <!-- Explicações do event loop -->
        <section>
          <section>
            <h1>Legal, mas... Como tudo isso funciona?</h1>
          </section>

          <section>
            <h1>O que o Node é:</h1>
            <ul>
              <li>Assíncrono</li>
              <li>Non blocking</li>
              <li>Single Thread</li>
            </ul>
          </section>

          <section>
            <h1>O que o Node <u>não</u> é:</h1>
            <ul>
              <li>Multi Core</li>
              <li>Multi thread</li>
              <li>A solução de todos os problemas</li>
            </ul>
          </section>

          <section>
            <h1>Event Loop</h1>
            <img src="https://camo.githubusercontent.com/c997d19ed67fc0ed69e91cf5e6d43489d767ac60/687474703a2f2f322e62702e626c6f6773706f742e636f6d2f2d576b33436a7a55667375672f56564835492d336d726b492f414141414141414141526b2f78464e5a7a626d5155466b2f73313630302f6c6f6f70322e706e67" alt="">
          </section>
        </section>









        <!-- Performance -->
        <section>
          <section>
            <h1>Performance com Node.js</h1>
          </section>

          <section>
            <h2>Causas de má performance</h2>
          </section>

          <section>
            <img src="https://cdn-thinkcomputers.netdna-ssl.com/wp-content/uploads/2014/03/cablemess-2.jpg" alt="Bad infra">
            <p>Má infraestrutura</p>
          </section>
          <section>
            <img src="https://camo.githubusercontent.com/cd64dd31db1acb25412a6c52e90e60d09cb17563/68747470733a2f2f6272756e6f6c6d2e66696c65732e776f726470726573732e636f6d2f323031372f30312f6861646f756b656e2d636f64652e6a7067" alt="Hadouken Code">
            <p>Código mal escrito</p>
          </section>
        </section>










        <!-- Divisão de infraestrutura -->
        <section>
          <h1>Performance em Infraestrutura</h1>
          <p>Let's talk about infra</p>
        </section>


<!-- Cache com NGINX -->

        <section>
          <section>
            <h3>Processamento desnecessário</h3>
            <p>Quando a mesma request é feita várias vezes seguidas</p>
          </section>

          <section>
              <h2>Solução: Cache</h2>
          </section>

          <section>
            <img src="img/cachenginx.png" alt="">
          </section>

          <section>
            <h3>Mãos a obra</h3>
            <img src="img/livedemo-1.png" alt="">
          </section>

          <section>
            <h2>Preparando</h2>
            <ul>
              <li>Crie uma pasta chamada <code>exemplo-1</code> em qualquer lugar</li>
              <li>Nela crie um arquivo chamado <code>nginx.conf</code></li>
            </ul>
          </section>

          <section>
            <h2>nginx.conf</h2>
            <img src="img/ex1/i1.png" alt="" width="500">
          </section>

          <section>
            <h2>criando o cache</h2>
            <img src="img/ex1/i2.png" alt="" width="500">
          </section>

          <section>
            <h2>aplicando o cache</h2>
            <img src="img/ex1/i3.png" alt="" width="500">
          </section>

          <section>
            <h2>Dockerfile</h2>
            <p>Crie um arquivo <code>Dockerfile</code></p>
            <img src="img/ex1/i4.png" alt="" width="500">
          </section>

          <section>
            <h2>Rodando</h2>
            <img src="img/ex1/i5.png" alt="" width="500">
          </section>

          <section>
            <h2>Mais além</h2>
            <img src="img/ex1/i6.png" alt="" width="650">
          </section>

        </section>


<!-- Conteúdo estático com NGINX -->

        <section>
          <section>
            <h3>Conteúdo estático sendo servido</h3>
            <p>O Node não foi feito para isto</p>
          </section>
          <section>
              <h2>Por que não usamos o NGINX?</h2>
          </section>
          <section>
            <h3>Mãos a obra</h3>
            <img src="img/livedemo-1.png" alt="">
          </section>
          <section>
            <h2>Preparando</h2>
            <ul>
              <li>Crie uma pasta chamada <code>exemplo-2</code> em qualquer lugar</li>
              <li>Nela crie um arquivo chamado <code>index.html</code></li>
              <li>Procure algumas imagens e coloque nesta pasta também</li>
            </ul>
          </section>
          <section>
            <h2>index.html</h2>
            <img src="img/ex2/i2.png" alt="" width="400">
          </section>
          <section>
            <p>O NGINX já tem uma imagem pronta para rodar conteúdo estático</p>
            <img src="img/ex2/i1.png" alt="" width="700">
          </section>
        </section>


<!-- Proxy Reverso -->


        <section>
          <section>
            <h3>Mau gerenciamento de conexões</h3>
            <ul>
              <li>O Node não é feito para gerenciar muitas conexões juntas</li>
              <li>Quando há um aumento repentino de conexões, é possível que a aplicação caia</li>
              <li>Servidores próprios como o Apache e o Nginx são melhores</li>
            </ul>
          </section>
          <section>
            <h2>Solução: Proxy reverso</h2>
          </section>
          <section>
            <img src="http://jamesthom.as/images/reverse_proxy.png" alt="Reverse proxy">
          </section>
          <section>
            <h3>Mãos a obra</h3>
            <img src="img/livedemo-1.png" alt="">
          </section>
          <section>
            <p>Clone o projeto com os exemplos</p>
            <img src="./img/clone.png" alt="">
          </section>
          <section>
            <p>Vamos para <code>exemplo-nginx-reverseproxy-docker</code></p>
          </section>
          <section>
            <p>Veja o arquivo <code>nginx.conf</code></p>
            <img src="./img/reverseproxy-nginxconf.png" alt="" width="700">
          </section>
          <section>
            <p>Tipo Round Robin - Um de cada vez</p>
            <img src="./img/reverseproxy-nginxconf-roundrobin.png" alt="" width="700">
          </section>
          <section>
            <p>Tipo IP Hash - Sempre para o mesmo</p>
            <img src="./img/reverseproxy-nginxconf-hash.png" alt="" width="700">
          </section>
          <section>
            <p>Ponderamento - pode ser usado em qualquer modo</p>
            <img src="./img/reverseproxy-nginxconf-weight.png" alt="" width="700">
          </section>
          <section>
            <p>Veja o arquivo <code>docker-compose.yml</code></p>
          </section>
          <section>
            <p>Veja o arquivo <code>app/index.js</code></p>
            <img src="./img/reverseproxy-node.png" alt="">
          </section>
          <section>
            <p>Vamos rodar</p>
            <img src="./img/reverseproxy-run-docker.png" alt="">
          </section>
        </section>
















        <!-- Divisão de código -->
        <section>
          <h1>Performance em Código</h1>
          <p>Show me!</p>
        </section>



        <!-- HashMaps (dar exemplo quando precisamos de informações que ainda não existem) -->
        <section>
          <h3>Otimizando decisões</h3>
          <section>
            <p>Podemos otimizar o nosso código somente trocando o jeito como escrevemos ele</p>
            <p>Vamos ver algumas opções</p>
          </section>

          <section>
            <p>O <code>else</code> é um constructo totalmente desnecessário</p>
            <img src="./img/else1.png" alt="" width="400">
          </section>
          <section>
            <p>Pode virar</p>
            <img src="./img/else2.png" alt="" width="500">
          </section>


          <section>
            <p>Switches podem ser substituidos por hashmaps</p>
            <img src="./img/switch1.png" alt="" width="400">
          </section>
          <section>
              <p>Pode virar</p>
              <img src="./img/switch2.png" alt="" width="500">
          </section>

        </section>






        <!-- Remoção de libs externas -->
        <section>
          <h3>Usando menos dependências</h3>
          <section>
            <h4>Evite usar Lodash, jQuery e etc</h4>
            <p>Quanto menos dependencias seu projeto tiver, mais rápido ele vai ser</p>
            <small>Opte sempre pela opção "vanilla"</small>
          </section>
          <section>
            <p>Isto é inútil</p>
            <img src="./img/lo1.png" alt="">
            <img src="./img/lo2.png" alt="">
            <img src="./img/lo3.png" alt="">
            <img src="./img/lo4.png" alt="">
            <img src="./img/lo5.png" alt="">
            <img src="./img/lo6.png" alt="">
            <img src="./img/lo7.png" alt="">
            <img src="./img/lo8.png" alt="">
          </section>
          <section>
            <p>Isto é meio util</p>
            <img src="./img/lou5.png" alt="">
            <img src="./img/lou6.png" alt="">
          </section>
          <section>
            <p>Isto é útil</p>
            <img src="./img/lou1.png" alt="">
            <img src="./img/lou2.png" alt="">
            <img src="./img/lou3.png" alt="">
            <img src="./img/lou4.png" alt="">
          </section>
        </section>


        <section>
          <section>
            <h2>Exercício</h2>
            <p>Implemente em javascript as seguintes funções do lodash</p>
          </section>
          <section>
            <img src="./img/lo1.png" alt="">
            <img src="./img/lo2.png" alt="">
            <img src="./img/lo3.png" alt="">
            <img src="./img/lo4.png" alt="">
            <img src="./img/lo5.png" alt="">
            <img src="./img/lo6.png" alt="">
            <img src="./img/lo7.png" alt="">
            <img src="./img/lo8.png" alt="">
            <img src="./img/lou5.png" alt="">
            <img src="./img/lou6.png" alt="">
          </section>
          <section>
            <h2>Respostas</h2>
          </section>
          <section>
            <h2>Concat</h2>
            <img id="left" src="./img/lo1.png" alt="">
            <img id="right" src="./img/lo1r.png" alt="">
          </section>
          <section>
            <h2>Fill</h2>
            <img id="left" src="./img/lo2.png" alt="">
            <img id="right" src="./img/lo2r.png" alt="">
          </section>
          <section>
            <h2>Head</h2>
            <img id="left" src="./img/lo3.png" alt="">
            <img id="right" src="./img/lo3r.png" alt="">
          </section>
          <section>
            <h2>Last</h2>
            <img id="left" src="./img/lo4.png" alt="">
            <img id="right" src="./img/lo4r.png" alt="">
          </section>
          <section>
            <h2>Tail</h2>
            <img id="left" src="./img/lo5.png" alt="">
            <img id="right" src="./img/lo5r.png" alt="">
          </section>
          <section>
            <h2>indexOf</h2>
            <img id="left" src="./img/lo6.png" alt="">
            <img id="right" src="./img/lo6r.png" alt="">
          </section>
          <section>
            <h2>Initial</h2>
            <img id="left" src="./img/lo7.png" alt="">
            <img id="right" src="./img/lo7r.png" alt="">
          </section>
          <section>
            <h2>Join</h2>
            <img id="left" src="./img/lo8.png" alt="">
            <img id="right" src="./img/lo8r.png" alt="">
          </section>
          <section>
            <h2>Flatten</h2>
            <img id="left" src="./img/lou5.png" alt="">
            <img id="right" src="./img/lou5r.png" alt="">
          </section>
          <section>
            <h2>Difference</h2>
            <img id="left" src="./img/lou6.png" alt="">
            <img id="right" src="./img/lou6r.png" alt="">
          </section>
          <section>
            <h2>Bonus: Intersect</h2>
            <img src="./img/louintersect.png" alt="">
          </section>
        </section>



        <!-- Uso de loops (map X For) -->
        <section>
          <h3>A guerra dos loops</h3>
          <section>
            <h4>Conteúdo aqui</h4>
          </section>
        </section>






        <!-- Paralelismo (Falar do promise.all com exemplos) -->
        <section>
          <h3>Tudo ao mesmo tempo</h3>
          <section>
            <h4>Conteúdo aqui</h4>
          </section>
        </section>



        <!-- Cluster API -->
        <section>
          <h3>Pode sim ser Multi thread</h3>
          <section>
            <h4>Conteúdo aqui</h4>
          </section>
        </section>








        <!-- Usando cache com Catbox e Redis -->
        <section>
          <h2>Cache a nível de aplicação</h2>
          <!-- Usando Redis e Catbox + Hapijs -->
          <section>
            <h4>Conteúdo aqui</h4>
          </section>
        </section>






        <!-- Profiling -->
        <section>
          <h1>Quando nada mais der certo</h1>
          <p>Vamos usar as <i>big guns</i></p>
        </section>




        <!-- Nativo -->
        <section>
          <h2>Profiler</h2>
          <section>
            <h4>Profiling nativo</h4>
          </section>
          <section>
            <h4>Flamegraphs</h4>
          </section>
        </section>







        <!-- Memory leaks -->
        <section>
          <h1>Memory Leaks</h1>
          <p>Seu pesadelo</p>
          <!-- Testes de memory leaks -->
          <!-- Identificando um memory leak -->
        </section>














        <!-- Projeto -->
        <section>
          <section>
            <h1>Projeto Final</h1>
          </section>
          <section>
            <h2>Objetivo</h2>
            <p>Criar um sistema utilizando as boas práticas de programação que vimos</p>
          </section>
          <section>
            <h2>Prazo</h2>
            <p>1 Semana</p>
          </section>
          <section>
            <h2>Detalhes do projeto</h2>
            <p>Uma escola veio até você para pedir que desenvolvesse um sistema para agendar reuniões entre professores e pais de alunos. Eis o que eles disseram:</p>
          </section>
          <section>
            <ul>
              <li>O sistema deve ter uma tela de login</li>
              <li>O sistema vai ter uma data de abertura, antes dela não é possível se logar</li>
              <li>O sistema vai ter uma data de fechamento, depois dela não é possível agendar reuniões, apenas ver as já agendadas</li>
              <li>As listas de professores e pais serão dadas pela escola</li>
              <li>Os pais terão uma senha gerada pelo programador</li>
              <li>Cada reunião dura, no máximo, 40 minutos</li>
              <li>As reuniões devem sempre ser marcadas após as 10 e antes das 17, que é o horário de funcionamento da escola</li>
            </ul>
          </section>
          <section>
            <h2>Mais regras</h2>
            <ul>
              <li>Um professor só pode ser agendado uma vez por horário</li>
              <li>Uma vez agendado aquele horário não estará mais disponível para nenhum pai para aquele professor</li>
              <li>Um pai só pode agendar uma reunião por dia</li>
            </ul>
          </section>
          <section>
            <p>Dadas estas instruções cabe a você achar a melhor resolução para o problema</p>
            <ul>
              <li>Você poderá escolher qualquer arquitetura</li>
              <li>Você poderá usar qualquer lib no back-end</li>
              <li>Todos os detalhes técnicos do projeto ficam a seu critério</li>
            </ul>
          </section>
          <section>
            <h2>O que será dado:</h2>
            <ul>
              <li>O front-end estará feito e desenhado (Framework CSS é o <a target="_blank" href="http://bulma.io">Bulma</a>)</li>
              <li>O banco de dados estará modelado e com dados</li>
            </ul>
          </section>
          <section>
            <h2>Regras <br> <small>Pra ficar mais legal</small></h2>
            <ul>
              <li>Nenhuma lib externa pode ser usada no front-end (todos os arquivos <code>.js</code> devem ser escritos em vanilla)</li>
              <li><u>Não</u> é permitido o uso de nenhum framework front-end (React, Angular, etc) para montar a tela</li>
              <li>A stack do front-end deve ser <b>apenas</b> HTML+JS+CSS, nada mais</li>
            </ul>
          </section>
          <section>
            <h2>Instruções:</h2>
            <ul>
              <li>Crie um fork do projeto <a target="_blank" href="http://github.com/khaosdoctor/desafio-curso-performance">Desafio</a> para o seu usuário no Github</li>
              <li>Todas as instruções estão no README</li>
            </ul>
          </section>
          <section>
            <h2>Entrega</h2>
            <ul>
              <li>Depois de finalizar o projeto, abra uma <i>pull-request</i> para o repositório original</li>
              <li>Use o título <code>[Seu nome] - Projeto final</code></li>
              <li>Escreva quaisquer comentários na descrição da PR</li>
              <li>Versione o flamegraph da sua api</li>
            </ul>
          </section>
        </section>





        <!-- Finalização -->

        <section style="text-align: left;">
          <h1>Referências</h1>
          <p>
            - <a href="https://nodejs.org/" target="_blank">Node.js: Página oficial</a> <br>
          </p>
        </section>

        <section>
            <h1>Code Prestige</h1>
            <h3>Ensino de programação</h3>
          </section>

      </div>

    </div>











    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>

      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/search/search.js', async: true },
          { src: 'plugin/zoom-js/zoom.js', async: true },
          { src: 'plugin/notes/notes.js', async: true }
        ]
      });

    </script>

  </body>
</html>
